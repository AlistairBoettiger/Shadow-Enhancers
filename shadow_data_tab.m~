
% Shadow Data Tabulated

% Alistair Boettiger
clear all;


SogPxYW_22C = [953 1265 754 848 .81 .90 2280 22;  %im 22
             674 1012 768 939 .72 .81 2158 21;
             1655 1279 1736 1438 .82 .777 2030 20;
             1474 261 987 239 .91 .69 1977 19;
             883 1560 808 928 0.796 0.93 1967 18;
             961 1128 998 1030 .74 0.81 2423 17;
             672 68 599 667 0.65 .83 2070 16;
             288 946 299 639 0.55 .86 2025 15;
             827 1002 900 988 .80 .89 2288 14;
             339 1096 872 919 .27 .72 2164 13;
             682 1035 555 765 .73 .85 2200 12;
             1482 1583 976 948 .88 .93 2110 11;
             900 1091 804 795 .65 .81 1542 10;
             1416 1673 1052 1098 .88 .94 2136 8;
             896 1253 822 996 .77 .90 2605 7;
             914 1668 797 1083 .87 .97 2357 6;
             1000 1369 665 871 .88 .95 2123 5;
             789 985 523 556 .87 .95 2197 3;
             888 1012 581 575 .90 .96 2218 1;
             1254 1504 730 831 .92 .97 2148 2];
         
         
 SogPxdl_25C = [665 1772 1031 1244 .71 .93 2331 17;
     324 1278 489 902 .67 .91 2061 16;
     461 1351 618 878 .71 .96 2250 15;
     2151 2251 1779 1695 .92 .93 2154 14;
     1949 1282 1912 1467 .90 .74 2213 13;
     601 1189 667 718 .76 .95 2172 12; 
     1481 1766 1550 1427 .87 .90 2123 10;
     2109 2397 1945 1877 .94 .90 2142 9;
     477 806 471 713 .57 .77 2235 8; 
     495 1405 720 906 .62 .93 2221 7;
     547 1807 822 1193 0.73 0.97 2332 6;
     633 1477 652 940 .81 .96 2047 5;
     831 2182 977 1297 .75 .96 2272 3;
     250 1220 242 801 .69 .90 1793 2;
     53 863 868 868 .09 .88 2105 1];
 
 
 SogPxda_25C = [847 1486 825 949 .82 .96 1681 9;
     670 743 576 502 .71 .92 2098 7;
     599 1158 658 658 .64 .97 1833 6;
     1382 1548 1029 903 .83 .96 1932 5;
     879 1668 791 1087 .85 .95 2097 4];

 SogSxYW_22C = [948,1771,932,1118,0.70064,0.9347,2267,1;
     772,1119,958,1169,0.66910,0.87,2330,2;
     1030,1417,850,970,0.776470000000000,0.907220000000000,2176,3;
     670,1199,668,797,0.627250000000000,0.843160000000000,2049,5;
     961,1168,801,772,0.757800000000000,0.902850000000000,2085,6;
     1001,1382,1096,952,0.64507,0.8792,2169,7;
     954,1054,970,990,0.68247,0.80707,1998,8;
     545,1381,862,1058,0.469840000000000,0.789220000000000,2037,9;
     1390,1626,1020,1042,0.842160000000000,0.897310000000000,2207,10;
     455,731,582,572,0.546390000000000,0.830420000000000,2158,12;
     1266,1107,969,863,0.767800000000000,0.834300000000000,1966,13;
     666,798,463,453,0.684670000000000,0.825610000000000,2077,14;
     1001,1104,1012,1030,0.696640000000000,0.844660000000000,2042,15;
     636,1000,562,566,0.649470000000000,0.869260000000000,930,16;
     1336,1600,915,970,0.848090000000000,0.911340000000000,1806,17;
     771,887,857,901,0.717620000000000,0.881240000000000,2271,18;
     279,356,246,227,0.658540000000000,0.828190000000000,1994,19;
     541,792,621,767,0.679550000000000,0.877440000000000,2124,20;
     833,1473,1068,1256,0.687270000000000,0.859870000000000,2368,21;
     805,949,827,1076,0.623940000000000,0.623610000000000,1911,22;
     671,900,776,929,0.601800000000000,0.725510000000000,2029,23;
     1115,983,974,837,0.763860000000000,0.879330000000000,1937,24;
     136,361,106,225,0.650940000000000,0.813330000000000,1865,26;
     1449,1493,1011,992,0.830860000000000,0.920360000000000,2185,27];
 
 SogSxdl6_25C = [876,1381,984,884,0.708330000000000,0.903850000000000,2420,1;29,951,948,948,0.0316460000000000,0.877640000000000,2051,2;350,548,602,473,0.581400000000000,0.862580000000000,2441,3;265,305,376,229,0.555850000000000,0.816590000000000,1973,4;666,958,858,840,0.664340000000000,0.809520000000000,2275,5;1082,1740,1312,1121,0.724850000000000,0.949150000000000,2259,6;409,912,623,691,0.598720000000000,0.901590000000000,2329,7;690,1336,855,868,0.727490000000000,0.935480000000000,2142,8;269,440,378,370,0.642860000000000,0.770270000000000,2419,9;342,531,451,478,0.658540000000000,0.751050000000000,2281,10;483,822,590,567,0.632200000000000,0.873020000000000,2141,11;241,612,454,461,0.418500000000000,0.765730000000000,2287,12;445,1294,700,1090,0.545710000000000,0.802750000000000,2037,13;519,1168,648,795,0.734570000000000,0.903140000000000,2209,14;1032,2125,1316,1357,0.715050000000000,0.944730000000000,2363,15;473,1319,673,925,0.653790000000000,0.921080000000000,2297,16;555,1506,697,920,0.638450000000000,0.936960000000000,1792,17;363,513,444,434,0.709460000000000,0.790320000000000,1766,18;97,151,104,77,0.548080000000000,0.792210000000000,2408,19;837,1938,969,1070,0.668730000000000,0.916820000000000,2280,20;1068,1425,1243,989,0.803700000000000,0.922140000000000,2197,21;651,1390,920,959,0.693480000000000,0.936390000000000,2151,22;227,736,366,450,0.407100000000000,0.811110000000000,1997,23;242,521,365,387,0.427400000000000,0.806200000000000,2411,24;]
 

%--
 Data = {
   sort( SogPxYW_22C(:,3)./SogPxYW_22C(:,4) ); 
   sort( SogPxdl_25C(:,3)./SogPxdl_25C(:,4) ); 
   sort( SogSxYW_22C(:,3)./SogSxYW_22C(:,4) ); 
 };
    
gene_names = {'SogPxYW_22C';'SogPxdl_25C'; 'SogSxYW_22C'};
%--

  
    
%     Data = {sort(SogPxYW_22C(:,5)); 
%         sort(SogPxYW_22C(:,6));
%         sort(SogPxdl_25C(:,5));
%         sort(SogPxdl_25C(:,6));
%         sort( SogPxYW_22C(:,5)./SogPxYW_22C(:,6) ); 
%         sort( SogPxdl_25C(:,5)./SogPxdl_25C(:,6) );
%         sort( SogSxYW_22C(:,5) );
%         sort( SogSxYW_22C(:,6) );
%         sort( SogSxYW_22C(:,5)./SogSxYW_22C(:,6) );        
%         };
%    
% gene_names = {'SogPxYW_22C'; 'Endgonous YW P'; 'SogPxdl_25C'; 'Endogenous dl';
%     'P-YW:End ratio'; 'P-dl:End ratio'; 'SogSxYW_22C';'End YW S';'S-YW: End ratio' };

%     %------------
%        Data = {
%         sort(SogPxYW_22C(:,6));
%         sort(SogPxdl_25C(:,6));
%         sort( SogPxYW_22C(:,5)./SogPxYW_22C(:,6) ); 
%         sort( SogPxdl_25C(:,5)./SogPxdl_25C(:,6) );
%         sort( SogSxYW_22C(:,6) );
%         sort( SogSxYW_22C(:,5)./SogSxYW_22C(:,6) );        
%         };
%     
%     
% gene_names = {'Endgonous YW P';  'Endogenous dl';
%     'P-YW:End ratio'; 'P-dl:End ratio';'End YW S';'S-YW: End ratio' };
%     %--------
    
        G = length(Data); 
  
% rescale 
embs = sum(cellfun('size', Data,1)) ;
L0 = 100;
DA = zeros(G,L0-1);
for g=1:G
    for i=1:L0-1
        k= 1+floor(length(Data{g})*i/L0);
        DA(g,i) = Data{g}(k); 
   end
end
 sat = .85;% 1.4;
 DA(DA>sat) = sat; % saturate to account for different strength signals that merge due to lack of resolution 

 
 
% sort by asynchrony score
asyncT = 1;% 1; % .8
Dt = DA; Dt(DA>asyncT)=NaN;
sv = nanmean(Dt,2);
%sv = mean(DA(DA<asyncT),2) ;% ./mean(DA>asyncT ,2);
%sv = std(DA')';
DAs = sortrows([sv,DA]); 
gs = sortrows([sv,(1:G)'])  ;


gn = gene_names(gs(:,2)); 
gene_names2 = [num2cell(sv),gene_names];

 D = DAs(:,2:end);
 D(D>1)=1; DA(DA>1)=1;
 F=14;
% 
 figure(2); clf; imagesc(D); figure(2);
 colorbar;  colordef white;
  set(gcf,'color','w');
set(gca,'YtickLabel',...
 str2mat(gn{:}),...
     'YTick',[1:G],'fontsize',3/4*F,...
    'YMinorTick','on');
ylabel('gene','Fontsize',F); 
xlabel('percent of embryos','Fontsize',F);
% colormap(C);
 colormap(1-hot(256));
% colormap(winter(256)); 
 % colormap(1-autumn(256));
title(['Fraction of activated nuclei for ' num2str(embs) ' embryos'],...
    'Fontsize',3/4*F);%,...
colordef white; set(gcf,'color','w');



 
  
  H = zeros(G,G); P = zeros(G,G);
 for i=1:G
     for j=1:G
      [H(i,j),Pt(i,j)] = ttest2(D(i,:),D(j,:));
     end
      Pt(i,i) = 1;
 end
 figure(11); clf;  imagesc(log(Pt));
 set(gca,'YtickLabel', str2mat(gn{:}),'YTick',[1:G],'YMinorTick','off','fontsize',14);
  set(gca,'XtickLabel', str2mat(gn{:}),'XTick',[1:G],'XMinorTick','off','fontsize',14);
 colorbar; colormap(winter); 
 
 

